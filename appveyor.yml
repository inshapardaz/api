version: 1.0.{build}
max_jobs: 1
image: Visual Studio 2017 Preview
before_build:
- cmd: dotnet restore ./Inshapardaz.Api.sln
build:
  project: src/Inshapardaz.Api.sln
  publish_wap_xcopy: true
  verbosity: minimal
after_build:
- cmd: dotnet publish -c Release src/Inshapardaz.Functions/Inshapardaz.Functions.csproj
test_script:
- cmd: cd src/Inshapardaz.Functions.Tests
- cmd: dotnet test --no-build
artifacts:
- path: src\Inshapardaz.Functions
  name: Functions
  type: Auto
deploy:
- provider: WebDeploy
  server: https://api-inshapardaz.scm.azurewebsites.net:443/msdeploy.axd?site=api-inshapardaz
  website: api-inshapardaz
  username: $api-inshapardaz
  password: 
    secure: JtybVbpTxTWp21oT11L4dL7KzpGW6DAovgmyo4Gw9iX0wKUuZd2vzN7t6stoUucU7tyLCFHsCEQ3yiiiulR18A==
  artifact: Functions
